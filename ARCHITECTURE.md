# Architecture

> Generated by python-codebase-mapper on 2026-02-24

## Overview
Digisale-Dash is a local Streamlit dashboard application for analyzing B2B/B2C sales data. It processes uploaded CSV/Excel files and visualizes key performance indicators (KPIs) like revenue, profit, and order status with interactive filtering.

## Project Type
Web App: Streamlit Dashboard
Python: 3.9+
Package Manager: pip
Virtual Environment: venv (detected)

## System Diagram
```text
  [app.py] → [data_loader.py]
           → [charts.py]
           → [error_logger.py]

  [data_loader.py] → [Memory / Session State]
  [charts.py]      → [Plotly Dashboards]
```

## Directory Structure
```text
digisale-dash/
├── .digido/                # Internal management (Roadmap, Spec, Phases)
├── .streamlit/             # Streamlit configuration (Theme: Dark Corporate)
├── app.py                  # Main UI entry point (Streamlit)
├── data_loader.py          # Data loading, validation, and KPI calculation module
├── charts.py               # Plotly chart generation module
├── error_logger.py         # Module for writing technical errors to log file
├── error_log.md            # Auto-generated system error log
├── requirements.txt        # Project dependencies
├── test_loader.py          # Simple testing script for data pipelines
└── *_deme.csv              # Mock data files for testing (Customers, Orders, Products)
```

## Components

### Main App
- **Purpose:** Renders the dashboard UI, manages file uploads, and maintains session state.
- **Location:** `app.py`
- **Key files:** `app.py`
- **Imports from:** `data_loader`, `charts`, `error_logger`
- **Imported by:** None

### Data Processing
- **Purpose:** Loads data from the uploaded files, validates expected columns, merges tables, and calculates KPIs.
- **Location:** `data_loader.py`
- **Key files:** `data_loader.py`
- **Imports from:** `pandas`, `io`
- **Imported by:** `app.py`, `test_loader.py`

### Visualizations
- **Purpose:** Generates interactive Plotly charts for revenue by category and segment.
- **Location:** `charts.py`
- **Key files:** `charts.py`
- **Imports from:** `plotly.express`, `pandas`
- **Imported by:** `app.py`

### Error Logging
- **Purpose:** Provides a centralized logging mechanism to write caught exceptions with timestamps to `error_log.md`.
- **Location:** `error_logger.py`
- **Key files:** `error_logger.py`
- **Imports from:** `datetime`, `pathlib`
- **Imported by:** `app.py`

## Entry Points
| Entry | File | How to Run |
|-------|------|------------|
| Streamlit App | `app.py` | `streamlit run app.py` |
| Pipeline Test | `test_loader.py`| `python test_loader.py` |

## Data Flow
1. User uploads Orders, Customers, and Products files (CSV/Excel) via frontend sidebar.
2. `app.py` parses files to Pandas Dataframes and passes them to `data_loader.load_and_validate`.
3. Validation checks for strictly required columns.
4. `data_loader.merge_data` merges the three dataframes and calculates per-row Revenue and Profit.
5. Calculated metrics are saved in Streamlit's `session_state`.
6. User can filter data globally using the City dropdown, updating the charts and KPI metrics.
7. Charts are rendered using `charts.py`.
8. Errors, if any, are routed to `error_logger.log_error` and saved to `error_log.md`.

## Integration Points
| External Service | Type | Package | Purpose |
|------------------|------|---------|---------|
| None | Local Filesystem | Built-in | Reads uploaded files and writes log file locally |

## Environment Variables
| Variable | Required | Used In | Purpose |
|----------|----------|---------|---------|
| None detected | no | - | - |

## Conventions
- **Naming:** standard snake_case for functions and variables.
- **Structure:** Modularized by function (UI, Data logic, Charts, Logging).
- **Error handling:** `try/except` blocks in `data_loader.py` raising specific error types. `app.py` catches all broad exceptions and relays to `error_logger`.
- **Testing:** Contains a basic script `test_loader.py` (prints to stdout), not using pytest/unittest frameworks.

## Technical Debt
| Item | Location | Severity | Effort |
|------|----------|----------|--------|
| No automated test suite | `test_loader.py` | med | moderate |
| Exception catching in data_loader is somewhat broad | `data_loader.py:38` | low | quick |

## Import Graph (Simplified)
```text
app
 ├─> data_loader
 ├─> charts
 └─> error_logger

test_loader
 └─> data_loader
```

## Circular Dependencies
None detected

## Notes
- `requirements.txt` is encoded in UTF-16LE, which may trip up some `pip` installations.
- Data validation ensures specific columns are strictly present; this will gracefully fail over to the UI if not.
